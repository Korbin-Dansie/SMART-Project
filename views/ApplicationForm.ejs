<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S. M. A. R. T. Application Form</title>
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/font/bootstrap-icons.css" />
    <%- include('partials/favico') %>
</head>

<script>
    function checkInput() {
        // Check that all required input is submitted.
        var validInput = false;

        const message = document.getElementById("message");

        if (document.getElementById("applicantFirstName").value == "") {message.textContent = "Enter your first name.";}
        else if (document.getElementById("applicantLastName").value == "") {message.textContent = "Enter your last name.";}
        else if (document.getElementById("applicantDoB").value == "") {message.textContent = "Enter your date of birth.";}
        else if (document.getElementById("applicantAddress").value == "") {message.textContent = "Enter your address (GPS coordinates).";}
        else if (document.getElementById("applicantSchoolLevel").value == "") {message.textContent = "Enter your school level.";}
        else if (document.getElementById("applicantGPA").value == "") {message.textContent = "Enter your school GPA.";}
        else if (!document.getElementById("guardian1")) {message.textContent = "Add at least one guardian.";}
        else if (document.getElementById("applicantGuardianIncome").value == "") {message.textContent = "Enter an annual household income.";}
        else if (document.getElementById("applicantShortEssay").value == "") {message.textContent = "Submit an answer in the final box.";}
        else validInput = true;

        if (!validInput) {
            event.preventDefault();
            return;
        }

        // Iterate through rows of the table to add their data to the form before submitting
        var guardianTable = document.getElementById("guardianTable");
        for (var i = 0, row; row = guardianTable.rows[i]; i ++) {
            // Update whatever form input will be sent to the post request
            var form = document.getElementById("form");

            var newGuardian = document.createElement("input");
            newGuardian.setAttribute("type", "hidden");
            newGuardian.setAttribute("name", "guardianName"+i);
            newGuardian.setAttribute("value", row.cells[0].value);
            newGuardian.setAttribute("id", "guardianName"+i);
            form.appendChild(newGuardian);

            var newGuardianPhone = document.createElement("input");
            newGuardianPhone.setAttribute("type", "hidden");
            newGuardianPhone.setAttribute("name", "guardianPhone"+i);
            newGuardianPhone.setAttribute("value", row.cells[1].value);
            newGuardianPhone.setAttribute("id", "guardianPhone"+i);
            form.appendChild(newGuardianPhone);

            var newGuardianEmail = document.createElement("input");
            newGuardianEmail.setAttribute("type", "hidden");
            newGuardianEmail.setAttribute("name", "guardianEmail"+i);
            newGuardianEmail.setAttribute("value", row.cells[2].value);
            newGuardianEmail.setAttribute("id", "guardianEmail"+i);
            form.appendChild(newGuardianEmail);
        }
    }

    function addGuardian() {
        // Check if input is valid
        var nameInput = document.getElementById("guardianName");
        var phoneInput = document.getElementById("guardianPhone");
        var emailInput = document.getElementById("guardianEmail");
        var errorText = document.getElementById("guardianError");
        if (nameInput.value == "") {
            errorText.textContent = "Enter a Guardian Name";
        } else {
            errorText.textContent = "";
            var guardianTable = document.getElementById("guardianTable");

            // Update the table
            var tableRows = guardianTable.rows.length;
            var row = guardianTable.insertRow(tableRows);
            var cellName = row.insertCell(0);
            var cellPhone = row.insertCell(1);
            var cellEmail = row.insertCell(2);

            cellName.innerHTML = nameInput.value;
            cellPhone.innerHTML = phoneInput.value;
            cellEmail.innerHTML = emailInput.value;
            
            row.setAttribute("id", "guardian"+tableRows);
        }
    }

    function removeGuardian() {
        // Check to make sure the table isn't empty
        var tableRows = guardianTable.rows.length - 1;
        if (tableRows > 0){
            // Delete most recent guardian from the table
            document.getElementById("guardian"+tableRows).remove();

            // Update input in the form
            var guardianToDelete = document.getElementById("guardianName"+tableRows);
            var guardianPhoneToDelete = document.getElementById("guardianPhone"+tableRows);
            var guardianEmailToDelete = document.getElementById("guardianEmail"+tableRows);

            guardianToDelete.remove();
            guardianPhoneToDelete.remove();
            guardianEmailToDelete.remove();
        }
    }
</script>

<body>
    <div class="container-fluid vh-100" style="margin-top:10px">
        <div class="" style="margin-top:100px">
            <div class="rounded d-flex justify-content-center">
                <div class="col-md-6 col-sm-12 shadow-lg p-5 bg-light">
                    <div class="text-center">
                        <h3 class="text-primary">Apply to Program</h3>
                    </div>
                    <form id="form" method="post" action="" onSubmit="">

                        <div class="row pt-4">
                            <div class="col-md-6">
                                <!--First Name-->
                                <div>
                                    <label>First Name:</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-person-circle text-white"></i></span>
                                        <input id="applicantFirstName" name="applicantFirstName" type="text"
                                            class="form-control" placeholder="Jane">
                                    </div>
                                </div>

                                <!--Last Name-->
                                <div>
                                    <label>Last Name:</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-person-circle text-white"></i></span>
                                        <input id="applicantLastName" name="applicantLastName" type="text"
                                            class="form-control" placeholder="Doe">
                                    </div>
                                </div>

                                <!--Date of Birth-->
                                <div>
                                    <label>Date of Birth:</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-calendar-date text-white"></i></span>
                                        <input id="applicantDoB" name="applicantDoB" type="text" class="form-control"
                                            placeholder="MM/DD/YYYY">
                                    </div>
                                </div>

                                <!--Address-->
                                <div>
                                    <label>Address:</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-house-door text-white"></i></span>
                                        <input id="applicantAddress" name="applicantAddress" type="text"
                                            class="form-control" placeholder="41°24'12.2&quot;N 2°10'26.5&quot;E">
                                    </div>
                                </div>

                                <!--Public School Level-->
                                <div>
                                    <label>Public School Level:</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-mortarboard text-white"></i></span>
                                        <input id="applicantSchoolLevel" name="applicantSchoolLevel" type="text"
                                            class="form-control" placeholder="10">
                                    </div>
                                </div>

                                <!--Public School GPA-->
                                <div>
                                    <label>Public School GPA:</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-mortarboard text-white"></i></span>
                                        <input id="applicantGPA" name="applicantGPA" type="text" class="form-control"
                                            placeholder="15">
                                    </div>
                                </div>

                                <!--Contact Information-->
                                <div>
                                    <label>Contact Information (optional):</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-telephone text-white"></i></span>
                                        <input id="applicantContact" name="applicantContact" type="text" class="form-control"
                                            placeholder="123-456-7890">
                                    </div>
                                </div>

                                <!--Transportation Assistance Radio Buttons-->
                                <div class="p-2">
                                    <label>Do you need Transportation Assistance?</label>
                                    <div class="input-group mb-1">
                                        <div class="form-check mx-1">
                                            <input class="form-check-input" type="radio" name="transportAssistRadio"
                                                id="noTransportAssist" checked value="false">
                                            <label class="form-check-label" for="transportAssistRadio">
                                                No
                                            </label>
                                        </div>
                                        <div class="form-check mx-1">
                                            <input class="form-check-input" type="radio" name="transportAssistRadio"
                                                id="yesTransportAssist" value="true">
                                            <label class="form-check-label" for="transportAssistRadio">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!--Meal Assistance Radio Buttons-->
                                <div class="p-2">
                                    <label>Do you need Meal Assistance?</label>
                                    <div class="input-group mb-1">
                                        <div class="form-check mx-1">
                                            <input class="form-check-input" type="radio" name="mealAssistRadio"
                                                id="noMealAssist" checked value="false">
                                            <label class="form-check-label" for="mealAssistRadio">
                                                No
                                            </label>
                                        </div>
                                        <div class="form-check mx-1">
                                            <input class="form-check-input" type="radio" name="mealAssistRadio"
                                                id="yesMealAssist" value="true">
                                            <label class="form-check-label" for="mealAssistRadio">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </div>


                            </div>

                            <div class="col-md-6">
                                <!--Guardian-->
                                <div>
                                    <label>Parent / Guardians:</label>
                                    <div class="input-group mb-3">
                                        <table class="table table-striped table-hover table-sm" id="guardianTable">
                                            <thead>
                                                <tr>
                                                    <th scope="col">Name</th>
                                                    <th scope="col">Phone</th>
                                                    <th scope="col">Email</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                            </tbody>
                                        </table>

                                        <label>Guardian Name</label>
                                        <div class="input-group">
                                            <input id="guardianName" name="guardianName" type="text" class="form-control"
                                                placeholder="Name">
                                        </div>
                                        
                                        <label>Phone number</label>
                                        <div class="input-group">
                                            <input id="guardianPhone" name="guardianPhone" type="tel" class="form-control"
                                                placeholder="Name">
                                        </div>

                                        <label>Email Address</label>
                                        <div class="input-group">
                                            <input id="guardianEmail" name="guardianEmail" type="email" class="form-control"
                                                placeholder="Name">
                                        </div>

                                        <div class="text-center">
                                            <button class="btn btn-primary mt-1" type="button" onclick="addGuardian()">
                                                Save
                                            </button>
                                            <button class="btn btn-primary mt-1" type="button" onclick="removeGuardian()">
                                                Remove Last
                                            </button>
                                        </div>

                                        <p id="guardianError" class="text-danger" style="height:25px"></p>
                                    </div>
                                </div>

                                <!--Guardian Income-->
                                <div>
                                    <label>Parent / Guardian Annual Income:</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text bg-primary"><i
                                                class="bi bi-cash text-white"></i></span>
                                        <input id="applicantGuardianIncome" name="applicantGuardianIncome" type="text" class="form-control"
                                            placeholder="MT 20,000">
                                    </div>
                                </div>

                                <div class="p-2">
                                    <label for="applicantShortEssay" class="form-label">Why do you Want to Enroll in the Program?</label>
                                    <textarea class="form-control" id="applicantShortEssay" rows="7"></textarea>
                                  </div>

                            </div>
                        </div>

                        <div class="text-center">
                            <p id="message" class="text-danger" style="height:25px">
                                <%- locals.message %>
                            </p>
                        </div>

                        <div class="text-center">
                            <button class="btn btn-primary mt-2" type="submit" onclick="checkInput()">
                                Submit Application
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>

</html>